angular.module("ngAjax",[]),angular.module("ngAjax").constant("ngAjaxFlow",{parallel:"parallel",series:"series"}).directive("ngAjax",function(){return{restrict:"E",require:["^ngAjaxControl","ngAjax"],controller:"ngAjaxController",link:function(n,o,t,r){r[1].init(r[0])}}}).directive("ngAjaxControl",function(){return{restrict:"E",controller:"ngAjaxControlController",link:function(n,o,t,r){}}}).directive("ngAjaxEmit",["$rootScope",function(n){return{link:function(o,t,r,e){function a(){n.$emit(r.ngAjaxEmit)}t.on("click",a),o.$on("$destroy",function(){t.off("click",a)})}}}]).controller("ngAjaxControlController",["$scope","$rootScope","$attrs","$parse","$q","ngAjaxDebounce","ngAjaxFlow",function(n,o,t,r,e,a,i){function l(){for(var n=!0,o=0;o<v.length&&(n=v[o].isReady(),n);o++);return n}function c(){var o=[];h(n,!0),angular.forEach(v,function(n){o.push(n.ajax())}),e.all(o).then(function(){h(n,!1)})}function u(){var o=function(o){o?console.log(o):h(n,!1)},t=function(n){return n>=v.length?void o():void v[n].ajax().then(function(){t(n+1)})["catch"](function(n){o(n)})};h(n,!0),t(0)}function f(){if(l())if(p===i.parallel)c();else{if(p!==i.series)throw"Not supported control flow: "+p;u()}}var s=void 0!==t.auto&&n.$eval(t.auto)!==!1,g=n.$eval(t.debounceDuration);g||0===g||(g=10);var p=t.flow||i.parallel,h=r(t.loading).assign||angular.noop,v=[];this.register=function(n){v.push(n)};var d=a(f,g);t.on&&o.$on(t.on,d),this.notifyOptionChanges=function(){s&&d()}}]).controller("ngAjaxController",["$rootScope","$scope","$attrs","$http","$parse","$q",function(n,o,t,r,e,a){var i,l="GET",c=t.method||l,u=e(t.loading).assign||angular.noop,f=e(t.ajaxSuccess).assign||angular.noop,s=e(t.ajaxError).assign||angular.noop;this.init=function(n){i=n,i.register(this)},this.isReady=function(){return!!o.$eval(t.url)};var g=function(n){if(!angular.isObject(n))return null==n?"":n.toString();var o,t,r,e,a,i,l,c="";for(o in n)if(t=n[o],t instanceof Array)for(l in t)a=t[l],r=o+"["+l+"]",i={},i[r]=a,c+=g(i)+"&";else if(t instanceof Object)for(e in t)a=t[e],r=o+"["+e+"]",i={},i[r]=a,c+=g(i)+"&";else void 0!==t&&null!==t&&(c+=encodeURIComponent(o)+"="+encodeURIComponent(t)+"&");return c.length?c.substr(0,c.length-1):c};this.ajax=function(){u(o,!0),f(o,null),s(o,null);var n=o.$eval(t.url),e=o.$eval(t.headers),i=o.$eval(t.body),p={method:c,url:n,headers:e,data:i,transformRequest:function(n,o){var t=o(),r=t["content-type"];return r&&r.indexOf("application/x-www-form-urlencoded")>=0?g(n):JSON.stringify(n)}};c===l&&(p.params=o.$eval(t.params));var h=a.defer();return r(p).then(function(n){f(o,n),h.resolve(n)})["catch"](function(n){s(o,n),h.reject(n)})["finally"](function(){u(o,!1)}),h.promise},o.$watchGroup([t.url,t.body],function(n){i.notifyOptionChanges()}),c===l&&o.$watch(t.params,function(n){i.notifyOptionChanges()})}]).service("ngAjaxDebounce",["$timeout",function(n){return function(o,t,r){function e(){var e,i=this,l=arguments,c=function(){a=null,r||(e=o.apply(i,l))},u=r&&!a;return a&&n.cancel(a),a=n(c,t),u&&(e=o.apply(i,l)),e}var a;return e.cancel=function(){n.cancel(a),a=null},e}}]);